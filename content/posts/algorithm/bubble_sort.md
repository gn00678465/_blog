---
title: "[演算法] Bubble Sort / 泡沫排序"
date: 2021-02-01T10:49:42+08:00
draft: false
categories: "演算法"
tags: ['排序']
enableMermaid: false
enableMathJax: true
draft: false
---

## Bubble Sort / 泡沫排序
泡沫排序是排序演算法中比較基礎的方式，所需的時間會隨著數列的長度**平方成長**。

排序方式為從一個數列中，由左至右取出兩個元素比較，將較大的元素與較小的元素交換，反之則不動，直到整個數列排序完成。

可以參考動態的[視覺網站](https://visualgo.net/en/sorting)，可以比較清楚的知道排序的方式。

## 排序流程
假設目前有一數列 `[8, 5, 10, 6]`
1. 第一輪排序。 
    1. $8 > 5$ 交換。`[5, 8, 10, 6]`
    1. $8 < 10$ 不須交換。
    1. $10 > 6$ 交換。`[5, 8, 6, 10]`
    - 最大值 10 排到最右邊，共比對 3 次。
1. 第二輪排序。
    1. $5 < 8$ 不須交換。
    1. $8 > 6$ 交換。`[5, 6, 8, 10]`
    - 只需比對到倒數第二個，共比對 2 次。
1. 第三輪排序
    1. $5 < 6$ 不須交換。
    - 只需比對到倒數第三個，共比對 1 次。 `[5, 6, 8, 10]`
1. 排序完成
- 以上流程，排序次數為**數列長度 - 1**。

## 時間複雜度
- 要執行 n - 1 輪，每輪要比較 n-1 ... 1 次。
1. 當數列元素有 4 個時，需要比對 $3 + 2 + 1 = 6$ 次。
2. 當數列元素有 5 個時，需要比對 $4 + 3 + 2 + 1 = 10$ 次。
3. 當數列元素有 n 個時，需要比對
    - $(n-1) + (n-2) + ... + 1 = (n * (n - 1))/2 = n^2/2 - n/2$ (等差級數)
    - 當 n 有無限 $\infty$ 多個元素時，平方以外的值可以忽略不計。
4. Bubble Sort 的時間複雜度為 **$O(n^2)$**，平方成長。

## JavaScript 泡沫排序
```js
function bubbleSort(arr) {
  for (let i = arr.length - 1; i >= 0; i--) {
  for (let j = 0; j < i; j++) {
    if (arr[j] > arr[j + 1]) {
      // 順序交換
      [arr[j], arr[j+1]] = [arr[j+1], arr[j]]
    }
  }
  }
}
```

## 當原始陣列已為已排序時

當傳入資料已經為排序完成的數列時，在整輪的排序中都沒有交換，可直接判斷排序完成。

```js
function bubbleSort(arr) {
  for (let i = arr.length - 1; i >= 0; i--) {
    // flag 紀錄有沒有執行過交換
    let swap = false;
    for (let j = 0; j < i; j++) {
      if (arr[j] > arr[j + 1]) {
        [arr[j], arr[j+1]] = [arr[j+1], arr[j]]
        swap = true;
      }
    }
    // 當都沒有交換的情況，直接判斷排序完成
    if(!swap) {
      break;
    }
  }
}
```